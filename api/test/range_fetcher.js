var expect  = require('chai').expect;
var request = require('request');

const hostname = 'http://localhost';
const server_port = 3080;

describe ('Fetching Partners', function() {
    describe ('Default Location', function() {
        it('Partners Range Fetcher content at 50 KM', function(done) {
            request(hostname+':'+server_port+'/api/partners/50&51.5144636,-0.142571' , function(error, response, body) {
                expected_response = [{"id":4,"urlName":"blue-square-360","organization":"Blue Square 360","customerLocations":"globally","willWorkRemotely":true,"website":"http://www.bluesquare360.com/","services":"Blue Square 360 provides a professionally managed service covering all areas of a 360Â° Feedback initiative. We're experienced in supporting projects of all sizes, and always deliver a personal service that provides the level of support you need to ensure your 360 initiative delivers results for the business.","offices":[{"location":"Singapore","address":"Ocean Financial Centre, Level 40, 10 Collyer Quay, Singapore, 049315","coordinates":"1.28304,103.85199319999992"},{"location":"London, UK","address":"St Saviours Wharf, London SE1 2BE","coordinates":"51.5014767,-0.0713608999999451"}],"distance":5.135546492130405,"addressInRange":"St Saviours Wharf, London SE1 2BE","lat":"51.5014767","lng":"-0.0713608999999451"},{"id":13,"urlName":"gallus-consulting","organization":"Gallus Consulting","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.gallusconsulting.com/","services":"We're strategy consultants with a difference - we work with organisations and their leaders to take them from strategy to reality. In our work with leaders we often use 360-degree feedback to identify capability gaps, improve self-awareness, and develop strategic and cultural alignment. Our aim is for believe-able leaders to emerge with the drive, capability and cultural fit to take strategy to reality.","offices":[{"location":"Northampton","address":"Newton House, Northampton Science Park, Moulton Park, Kings Park Road, Northampton, NN3 6LG","coordinates":"52.277409,-0.877935999999977"},{"location":"London","address":"No1 Royal Exchange, London, EC3V 3DG","coordinates":"51.5136102,-0.08757919999993646"},{"location":"Manchester","address":"3 Hardman Square, Spinningfields, Manchester, M3 3EB","coordinates":"53.47990859999999,-2.2510892999999896"}],"distance":3.8065685872130155,"addressInRange":"No1 Royal Exchange, London, EC3V 3DG","lat":"51.5136102","lng":"-0.08757919999993646"}];
                expected_response_string = JSON.stringify(expected_response)

                expect(body).to.equal(expected_response_string);
                done();
            });    
        });

        it('Partners Range Fetcher content at 100 KM', function(done) {
            request(hostname+':'+server_port+'/api/partners/100&51.5144636,-0.142571' , function(error, response, body) {
                expected_response = [{"id":4,"urlName":"blue-square-360","organization":"Blue Square 360","customerLocations":"globally","willWorkRemotely":true,"website":"http://www.bluesquare360.com/","services":"Blue Square 360 provides a professionally managed service covering all areas of a 360Â° Feedback initiative. We're experienced in supporting projects of all sizes, and always deliver a personal service that provides the level of support you need to ensure your 360 initiative delivers results for the business.","offices":[{"location":"Singapore","address":"Ocean Financial Centre, Level 40, 10 Collyer Quay, Singapore, 049315","coordinates":"1.28304,103.85199319999992"},{"location":"London, UK","address":"St Saviours Wharf, London SE1 2BE","coordinates":"51.5014767,-0.0713608999999451"}],"distance":5.135546492130405,"addressInRange":"St Saviours Wharf, London SE1 2BE","lat":"51.5014767","lng":"-0.0713608999999451"},{"id":13,"urlName":"gallus-consulting","organization":"Gallus Consulting","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.gallusconsulting.com/","services":"We're strategy consultants with a difference - we work with organisations and their leaders to take them from strategy to reality. In our work with leaders we often use 360-degree feedback to identify capability gaps, improve self-awareness, and develop strategic and cultural alignment. Our aim is for believe-able leaders to emerge with the drive, capability and cultural fit to take strategy to reality.","offices":[{"location":"Northampton","address":"Newton House, Northampton Science Park, Moulton Park, Kings Park Road, Northampton, NN3 6LG","coordinates":"52.277409,-0.877935999999977"},{"location":"London","address":"No1 Royal Exchange, London, EC3V 3DG","coordinates":"51.5136102,-0.08757919999993646"},{"location":"Manchester","address":"3 Hardman Square, Spinningfields, Manchester, M3 3EB","coordinates":"53.47990859999999,-2.2510892999999896"}],"distance":98.70635654890351,"addressInRange":"Newton House, Northampton Science Park, Moulton Park, Kings Park Road, Northampton, NN3 6LG","lat":"52.277409","lng":"-0.877935999999977"},{"id":13,"urlName":"gallus-consulting","organization":"Gallus Consulting","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.gallusconsulting.com/","services":"We're strategy consultants with a difference - we work with organisations and their leaders to take them from strategy to reality. In our work with leaders we often use 360-degree feedback to identify capability gaps, improve self-awareness, and develop strategic and cultural alignment. Our aim is for believe-able leaders to emerge with the drive, capability and cultural fit to take strategy to reality.","offices":[{"location":"Northampton","address":"Newton House, Northampton Science Park, Moulton Park, Kings Park Road, Northampton, NN3 6LG","coordinates":"52.277409,-0.877935999999977"},{"location":"London","address":"No1 Royal Exchange, London, EC3V 3DG","coordinates":"51.5136102,-0.08757919999993646"},{"location":"Manchester","address":"3 Hardman Square, Spinningfields, Manchester, M3 3EB","coordinates":"53.47990859999999,-2.2510892999999896"}],"distance":3.8065685872130155,"addressInRange":"No1 Royal Exchange, London, EC3V 3DG","lat":"51.5136102","lng":"-0.08757919999993646"}];
                expected_response_string = JSON.stringify(expected_response)

                expect(body).to.equal(expected_response_string);
                done();
            });    
        });

        it('Partners Range Fetcher content at 150 KM', function(done) {
            request(hostname+':'+server_port+'/api/partners/150&51.5144636,-0.142571' , function(error, response, body) {
                expected_response = [{"id":4,"urlName":"blue-square-360","organization":"Blue Square 360","customerLocations":"globally","willWorkRemotely":true,"website":"http://www.bluesquare360.com/","services":"Blue Square 360 provides a professionally managed service covering all areas of a 360Â° Feedback initiative. We're experienced in supporting projects of all sizes, and always deliver a personal service that provides the level of support you need to ensure your 360 initiative delivers results for the business.","offices":[{"location":"Singapore","address":"Ocean Financial Centre, Level 40, 10 Collyer Quay, Singapore, 049315","coordinates":"1.28304,103.85199319999992"},{"location":"London, UK","address":"St Saviours Wharf, London SE1 2BE","coordinates":"51.5014767,-0.0713608999999451"}],"distance":5.135546492130405,"addressInRange":"St Saviours Wharf, London SE1 2BE","lat":"51.5014767","lng":"-0.0713608999999451"},{"id":13,"urlName":"gallus-consulting","organization":"Gallus Consulting","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.gallusconsulting.com/","services":"We're strategy consultants with a difference - we work with organisations and their leaders to take them from strategy to reality. In our work with leaders we often use 360-degree feedback to identify capability gaps, improve self-awareness, and develop strategic and cultural alignment. Our aim is for believe-able leaders to emerge with the drive, capability and cultural fit to take strategy to reality.","offices":[{"location":"Northampton","address":"Newton House, Northampton Science Park, Moulton Park, Kings Park Road, Northampton, NN3 6LG","coordinates":"52.277409,-0.877935999999977"},{"location":"London","address":"No1 Royal Exchange, London, EC3V 3DG","coordinates":"51.5136102,-0.08757919999993646"},{"location":"Manchester","address":"3 Hardman Square, Spinningfields, Manchester, M3 3EB","coordinates":"53.47990859999999,-2.2510892999999896"}],"distance":98.70635654890351,"addressInRange":"Newton House, Northampton Science Park, Moulton Park, Kings Park Road, Northampton, NN3 6LG","lat":"52.277409","lng":"-0.877935999999977"},{"id":13,"urlName":"gallus-consulting","organization":"Gallus Consulting","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.gallusconsulting.com/","services":"We're strategy consultants with a difference - we work with organisations and their leaders to take them from strategy to reality. In our work with leaders we often use 360-degree feedback to identify capability gaps, improve self-awareness, and develop strategic and cultural alignment. Our aim is for believe-able leaders to emerge with the drive, capability and cultural fit to take strategy to reality.","offices":[{"location":"Northampton","address":"Newton House, Northampton Science Park, Moulton Park, Kings Park Road, Northampton, NN3 6LG","coordinates":"52.277409,-0.877935999999977"},{"location":"London","address":"No1 Royal Exchange, London, EC3V 3DG","coordinates":"51.5136102,-0.08757919999993646"},{"location":"Manchester","address":"3 Hardman Square, Spinningfields, Manchester, M3 3EB","coordinates":"53.47990859999999,-2.2510892999999896"}],"distance":3.8065685872130155,"addressInRange":"No1 Royal Exchange, London, EC3V 3DG","lat":"51.5136102","lng":"-0.08757919999993646"},{"id":6,"urlName":"inspire-ignite","organization":"Inspire - Ignite","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.inspireignite.net/","services":"'Inspire - Ignite' is built on the philosophy that people perform better when they can be themselves. We work with individuals and organisations to be their best, achieve ambitions and be a success. We use Clarity4D and the concept of colour and 360 to build personal awareness and action plans.","offices":[{"location":"Peterborough, UK","address":"29 Warren Court, Hampton Hargate, Peterborough, PE7 8HA","coordinates":"52.5381398,-0.2713853000000199"}],"distance":114.16822457237541,"addressInRange":"29 Warren Court, Hampton Hargate, Peterborough, PE7 8HA","lat":"52.5381398","lng":"-0.2713853000000199"},{"id":2,"urlName":"spring-development","organization":"Spring Development","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.springdevelopment.net/","services":"We provide training, coaching and consultancy to ensure that 360 feedback is delivered positively and constructively, maximising personal development. We can train your people to carry out effective feedback meetings or, if you would benefit from having external, impartial facilitators, we can come and do them for you. We're always happy to have an initial confidential discussion to explore how we can help you.","offices":[{"location":"Banbury, Oxfordshire","address":"Banbury, Oxfordshire","coordinates":"52.0629009,-1.3397750000000315"}],"distance":102.46576655871048,"addressInRange":"Banbury, Oxfordshire","lat":"52.0629009","lng":"-1.3397750000000315"}];
                expected_response_string = JSON.stringify(expected_response)

                expect(body).to.equal(expected_response_string);
                done();
            });    
        });

        it('Partners Range Fetcher content at 250 KM', function(done) {
            request(hostname+':'+server_port+'/api/partners/250&51.5144636,-0.142571' , function(error, response, body) {
                expected_response = [{"id":4,"urlName":"blue-square-360","organization":"Blue Square 360","customerLocations":"globally","willWorkRemotely":true,"website":"http://www.bluesquare360.com/","services":"Blue Square 360 provides a professionally managed service covering all areas of a 360Â° Feedback initiative. We're experienced in supporting projects of all sizes, and always deliver a personal service that provides the level of support you need to ensure your 360 initiative delivers results for the business.","offices":[{"location":"Singapore","address":"Ocean Financial Centre, Level 40, 10 Collyer Quay, Singapore, 049315","coordinates":"1.28304,103.85199319999992"},{"location":"London, UK","address":"St Saviours Wharf, London SE1 2BE","coordinates":"51.5014767,-0.0713608999999451"}],"distance":5.135546492130405,"addressInRange":"St Saviours Wharf, London SE1 2BE","lat":"51.5014767","lng":"-0.0713608999999451"},{"id":13,"urlName":"gallus-consulting","organization":"Gallus Consulting","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.gallusconsulting.com/","services":"We're strategy consultants with a difference - we work with organisations and their leaders to take them from strategy to reality. In our work with leaders we often use 360-degree feedback to identify capability gaps, improve self-awareness, and develop strategic and cultural alignment. Our aim is for believe-able leaders to emerge with the drive, capability and cultural fit to take strategy to reality.","offices":[{"location":"Northampton","address":"Newton House, Northampton Science Park, Moulton Park, Kings Park Road, Northampton, NN3 6LG","coordinates":"52.277409,-0.877935999999977"},{"location":"London","address":"No1 Royal Exchange, London, EC3V 3DG","coordinates":"51.5136102,-0.08757919999993646"},{"location":"Manchester","address":"3 Hardman Square, Spinningfields, Manchester, M3 3EB","coordinates":"53.47990859999999,-2.2510892999999896"}],"distance":98.70635654890351,"addressInRange":"Newton House, Northampton Science Park, Moulton Park, Kings Park Road, Northampton, NN3 6LG","lat":"52.277409","lng":"-0.877935999999977"},{"id":13,"urlName":"gallus-consulting","organization":"Gallus Consulting","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.gallusconsulting.com/","services":"We're strategy consultants with a difference - we work with organisations and their leaders to take them from strategy to reality. In our work with leaders we often use 360-degree feedback to identify capability gaps, improve self-awareness, and develop strategic and cultural alignment. Our aim is for believe-able leaders to emerge with the drive, capability and cultural fit to take strategy to reality.","offices":[{"location":"Northampton","address":"Newton House, Northampton Science Park, Moulton Park, Kings Park Road, Northampton, NN3 6LG","coordinates":"52.277409,-0.877935999999977"},{"location":"London","address":"No1 Royal Exchange, London, EC3V 3DG","coordinates":"51.5136102,-0.08757919999993646"},{"location":"Manchester","address":"3 Hardman Square, Spinningfields, Manchester, M3 3EB","coordinates":"53.47990859999999,-2.2510892999999896"}],"distance":3.8065685872130155,"addressInRange":"No1 Royal Exchange, London, EC3V 3DG","lat":"51.5136102","lng":"-0.08757919999993646"},{"id":6,"urlName":"inspire-ignite","organization":"Inspire - Ignite","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.inspireignite.net/","services":"'Inspire - Ignite' is built on the philosophy that people perform better when they can be themselves. We work with individuals and organisations to be their best, achieve ambitions and be a success. We use Clarity4D and the concept of colour and 360 to build personal awareness and action plans.","offices":[{"location":"Peterborough, UK","address":"29 Warren Court, Hampton Hargate, Peterborough, PE7 8HA","coordinates":"52.5381398,-0.2713853000000199"}],"distance":114.16822457237541,"addressInRange":"29 Warren Court, Hampton Hargate, Peterborough, PE7 8HA","lat":"52.5381398","lng":"-0.2713853000000199"},{"id":2,"urlName":"spring-development","organization":"Spring Development","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.springdevelopment.net/","services":"We provide training, coaching and consultancy to ensure that 360 feedback is delivered positively and constructively, maximising personal development. We can train your people to carry out effective feedback meetings or, if you would benefit from having external, impartial facilitators, we can come and do them for you. We're always happy to have an initial confidential discussion to explore how we can help you.","offices":[{"location":"Banbury, Oxfordshire","address":"Banbury, Oxfordshire","coordinates":"52.0629009,-1.3397750000000315"}],"distance":102.46576655871048,"addressInRange":"Banbury, Oxfordshire","lat":"52.0629009","lng":"-1.3397750000000315"}];
                expected_response_string = JSON.stringify(expected_response)

                expect(body).to.equal(expected_response_string);
                done();
            });    
        });
    });

    
    describe ('Dynamic Location', function() {
        it('Partners Range Fetcher content at 200 KM at different location', function(done) {
            request(hostname+':'+server_port+'/api/partners/250&50.5144636,-0.142571' , function(error, response, body) {
                expected_response = [{"id":4,"urlName":"blue-square-360","organization":"Blue Square 360","customerLocations":"globally","willWorkRemotely":true,"website":"http://www.bluesquare360.com/","services":"Blue Square 360 provides a professionally managed service covering all areas of a 360Â° Feedback initiative. We're experienced in supporting projects of all sizes, and always deliver a personal service that provides the level of support you need to ensure your 360 initiative delivers results for the business.","offices":[{"location":"Singapore","address":"Ocean Financial Centre, Level 40, 10 Collyer Quay, Singapore, 049315","coordinates":"1.28304,103.85199319999992"},{"location":"London, UK","address":"St Saviours Wharf, London SE1 2BE","coordinates":"51.5014767,-0.0713608999999451"}],"distance":109.863861664371,"addressInRange":"St Saviours Wharf, London SE1 2BE","lat":"51.5014767","lng":"-0.0713608999999451"},{"id":13,"urlName":"gallus-consulting","organization":"Gallus Consulting","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.gallusconsulting.com/","services":"We're strategy consultants with a difference - we work with organisations and their leaders to take them from strategy to reality. In our work with leaders we often use 360-degree feedback to identify capability gaps, improve self-awareness, and develop strategic and cultural alignment. Our aim is for believe-able leaders to emerge with the drive, capability and cultural fit to take strategy to reality.","offices":[{"location":"Northampton","address":"Newton House, Northampton Science Park, Moulton Park, Kings Park Road, Northampton, NN3 6LG","coordinates":"52.277409,-0.877935999999977"},{"location":"London","address":"No1 Royal Exchange, London, EC3V 3DG","coordinates":"51.5136102,-0.08757919999993646"},{"location":"Manchester","address":"3 Hardman Square, Spinningfields, Manchester, M3 3EB","coordinates":"53.47990859999999,-2.2510892999999896"}],"distance":202.55784105406286,"addressInRange":"Newton House, Northampton Science Park, Moulton Park, Kings Park Road, Northampton, NN3 6LG","lat":"52.277409","lng":"-0.877935999999977"},{"id":13,"urlName":"gallus-consulting","organization":"Gallus Consulting","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.gallusconsulting.com/","services":"We're strategy consultants with a difference - we work with organisations and their leaders to take them from strategy to reality. In our work with leaders we often use 360-degree feedback to identify capability gaps, improve self-awareness, and develop strategic and cultural alignment. Our aim is for believe-able leaders to emerge with the drive, capability and cultural fit to take strategy to reality.","offices":[{"location":"Northampton","address":"Newton House, Northampton Science Park, Moulton Park, Kings Park Road, Northampton, NN3 6LG","coordinates":"52.277409,-0.877935999999977"},{"location":"London","address":"No1 Royal Exchange, London, EC3V 3DG","coordinates":"51.5136102,-0.08757919999993646"},{"location":"Manchester","address":"3 Hardman Square, Spinningfields, Manchester, M3 3EB","coordinates":"53.47990859999999,-2.2510892999999896"}],"distance":111.16660784575348,"addressInRange":"No1 Royal Exchange, London, EC3V 3DG","lat":"51.5136102","lng":"-0.08757919999993646"},{"id":6,"urlName":"inspire-ignite","organization":"Inspire - Ignite","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.inspireignite.net/","services":"'Inspire - Ignite' is built on the philosophy that people perform better when they can be themselves. We work with individuals and organisations to be their best, achieve ambitions and be a success. We use Clarity4D and the concept of colour and 360 to build personal awareness and action plans.","offices":[{"location":"Peterborough, UK","address":"29 Warren Court, Hampton Hargate, Peterborough, PE7 8HA","coordinates":"52.5381398,-0.2713853000000199"}],"distance":225.19880936491484,"addressInRange":"29 Warren Court, Hampton Hargate, Peterborough, PE7 8HA","lat":"52.5381398","lng":"-0.2713853000000199"},{"id":2,"urlName":"spring-development","organization":"Spring Development","customerLocations":"across the UK","willWorkRemotely":true,"website":"http://www.springdevelopment.net/","services":"We provide training, coaching and consultancy to ensure that 360 feedback is delivered positively and constructively, maximising personal development. We can train your people to carry out effective feedback meetings or, if you would benefit from having external, impartial facilitators, we can come and do them for you. We're always happy to have an initial confidential discussion to explore how we can help you.","offices":[{"location":"Banbury, Oxfordshire","address":"Banbury, Oxfordshire","coordinates":"52.0629009,-1.3397750000000315"}],"distance":191.24380256828658,"addressInRange":"Banbury, Oxfordshire","lat":"52.0629009","lng":"-1.3397750000000315"}];
                expected_response_string = JSON.stringify(expected_response)

                expect(body).to.equal(expected_response_string);
                done();
            });    
        });  
    });
});